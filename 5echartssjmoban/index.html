<!DOCTYPE html>
<html>
  <head>
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta
          name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
        />
        <title>票务收入分析</title>

        <link rel="stylesheet" href="../font/iconfont.css" />

        <link rel="stylesheet" href="../header.css" />

        <link type="text/css" href="css/public.css" rel="stylesheet" />
        <link type="text/css" href="css/index.css" rel="stylesheet" />
        <script src="https://www.jq22.com/jquery/jquery-1.10.2.js"></script>
        <script src="../vue.min.js"></script>
        <link
          rel="stylesheet"
          href="https://cdn.bootcdn.net/ajax/libs/element-ui/2.11.1/theme-chalk/index.css"
        />
        <script src="https://cdn.bootcdn.net/ajax/libs/element-ui/2.11.1/index.js"></script>
        <script type="text/javascript">
          document.documentElement.style.fontSize =
            (document.documentElement.clientWidth / 768) * 100 + 'px'
        </script>

        <script src="https://www.jq22.com/jquery/echarts-4.2.1.min.js"></script>
      </head>
      <body>
        <div class="bg">
          <!-- <div class="title"></div> -->
          <div class="topHeder">
            <div class="header-left fl">
              <nav class="menu radius">
                <ul class="nav">
                  <li style="font-size: 20px; margin-left: 80px" class="navli">
                    票务收入分析
                  </li>
                  <li class="navli">
                    <a href="#" style="width: 130px; text-align: center">
                      <span
                        class="iconfont icon-sanjiaodown"
                        style="font-size: 20px"
                      ></span>
                    </a>

                    <ul class="navBar">
                      <li>
                        <a href="../index.html">返回首页</a>
                      </li>
                      <li>
                        <a href="../index/index.html">景区综合监测</a>
                      </li>
                      <li>
                        <a href="../2jqueryechartsclgl/index.html"
                          >停车场数据分析</a
                        >
                      </li>
                      <li>
                        <a href="../5echartssjmoban/index.html">票务收入分析</a>
                      </li>
                      <li>
                        <a href="../12echartswldsj/index.html">游客接待分析</a>
                      </li>
                      <li>
                        <a href="../7echartsTourist/index.html">游客客源分析</a>
                      </li>
                      <li>
                        <a href="../4estsjksh/index.html">游客画像分析</a>
                      </li>
                      <li>
                        <a href="../8echartsjkmooban/index.html"
                          >WIFI数据分析</a
                        >
                      </li>
                      <li>
                        <a href="../order_ticket/index.html">票务预订分析</a>
                      </li>
                      <li>
                        <a href="../6jquerygndsjmoban/index.html">舆情分析</a>
                      </li>
                      <li>
                        <a href="../17eslydsj/index.html">指挥调度</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </nav>
            </div>
            <div class="header-center fl">
              <div class="header-title">青要山大数据综合管控平台</div>
            </div>
            <div class="header-right fl">
              <el-date-picker
                v-model="value1"
                type="daterange"
                range-separator="至"
                start-placeholder="开始日期"
                end-placeholder="结束日期"
                @change="datachange"
                format="yyyy-MM-dd"
                value-format="yyyy-MM-dd"
              >
              </el-date-picker>
            </div>
          </div>

          <div class="content">
            <div class="leftMain">
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>停车场检测</span>
                </div>
                <h3 class="h3title">本期</h3>
                <ul class="leftMain_ul">
                  <li>
                    <p>今日接待(人)</p>
                    <span id="customer_today">2020</span>
                  </li>
                  <li>
                    <p>上山人数</p>
                    <span id="uphill">3598</span>
                  </li>
                </ul>
                <h3 class="h3title">本期</h3>
                <ul class="leftMain_ul">
                  <li>
                    <p>下山人数</p>
                    <span id="downhill">180</span>
                  </li>
                  <li>
                    <p>山上停留人数</p>
                    <span id="onhill">3418</span>
                  </li>
                </ul>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>客户类型数据</span>
                </div>
                <div>
                  <ol class="leftMain_ol">
                    <li class="leftMain_ol_header">团队</li>
                    <li class="leftMain_ol_header">游客</li>
                    <li class="leftMain_ol_header">分销</li>
                    <li>
                      <p>本期</p>
                      <span><b id="current_team">25195</b>张</span>
                    </li>
                    <li>
                      <p>本期</p>
                      <span><b id="current_tourist">25195</b>张</span>
                    </li>
                    <li>
                      <p>本期</p>
                      <span><b id="current_distribution">25195</b>张</span>
                    </li>
                    <li>
                      <p>同期</p>
                      <span><b>6</b>张</span>
                    </li>
                    <li>
                      <p>同期</p>
                      <span><b>9</b>张</span>
                    </li>
                    <li>
                      <p>同期</p>
                      <span><b>5</b>张</span>
                    </li>
                  </ol>
                </div>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>旅游社分析排行</span>
                </div>
                <div
                  class="biaoge biaoge_pai"
                  style="width: 100%; height: 25vh"
                >
                  <div class="biaoge_paiIn">
                    <ul>
                      <li>
                        <div class="liIn">
                          <div class="liIn_left">
                            <span class="bot"></span
                            ><span class="zi">第一名</span>
                          </div>
                          <div class="liIn_line">
                            <div class="line_lineIn" style="width: 98.5%"></div>
                          </div>
                          <p class="num">98.5%</p>
                        </div>
                      </li>
                      <li>
                        <div class="liIn liIn2">
                          <div class="liIn_left">
                            <span class="bot"></span
                            ><span class="zi">第二名</span>
                          </div>
                          <div class="liIn_line">
                            <div class="line_lineIn" style="width: 88.5%"></div>
                          </div>
                          <p class="num">88.5%</p>
                        </div>
                      </li>
                      <li>
                        <div class="liIn liIn3">
                          <div class="liIn_left">
                            <span class="bot"></span
                            ><span class="zi">第三名</span>
                          </div>
                          <div class="liIn_line">
                            <div class="line_lineIn" style="width: 68.5%"></div>
                          </div>
                          <p class="num">68.5%</p>
                        </div>
                      </li>
                      <li>
                        <div class="liIn liIn4">
                          <div class="liIn_left">
                            <span class="bot"></span
                            ><span class="zi">第四名</span>
                          </div>
                          <div class="liIn_line">
                            <div class="line_lineIn" style="width: 40.5%"></div>
                          </div>
                          <p class="num">40.5%</p>
                        </div>
                      </li>
                      <li>
                        <div class="liIn liIn5">
                          <div class="liIn_left">
                            <span class="bot"></span
                            ><span class="zi">第五名</span>
                          </div>
                          <div class="liIn_line">
                            <div class="line_lineIn" style="width: 22.5%"></div>
                          </div>
                          <p class="num">22.5%</p>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="boxfoot"></div>
              </div>
            </div>
            <div class="middleMain">
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>近30天销售趋势</span>
                </div>
                <div>
                  <div class="allnav" id="chart_6" style="height: 213px"></div>
                </div>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>近12月销售趋势</span>
                </div>
                <div>
                  <div
                    class="biaoge"
                    style="width: 100%; height: 25vh"
                    id="chart_5"
                  ></div>
                </div>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>近10年销售趋势</span>
                </div>
                <div>
                  <div class="allnav" id="chart_4" style="height: 200px"></div>
                </div>
                <div class="boxfoot"></div>
              </div>
            </div>
            <div class="RightMain">
              <div class="rightMain_bottomIn leftMain_info public">
                <div class="min-title">
                  <span>产品销售排行</span>
                </div>
                <div
                  id="product"
                  class="biaoge biaoge_list"
                  style="width: 100%; height: 210px"
                ></div>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>销售渠道分析</span>
                </div>
                <div id="chart3" class="allnav" style="height: 203px"></div>
                <div class="boxfoot"></div>
              </div>
              <div class="leftMain_info public">
                <div class="min-title">
                  <span>OTA分销排行</span>
                </div>
                <div class="title-nav" id="chart2" style="height: 200px"></div>
                <div class="boxfoot"></div>
              </div>
            </div>
          </div>
        </div>
        <!--数字增长累加动画-->
        <script src="https://www.jq22.com/jquery/jquery-1.10.2.js"></script>
        <script src="../commonInterface.js"></script>
        <script
          src="js/jquery.numscroll.js"
          type="text/javascript"
          charset="utf-8"
        ></script>
        <script type="text/javascript">
          var startDate = ''
          var endDate = ''

          new Vue({
            el: '.topHeder',
            data: function () {
              return {
                value1: ''
              }
            },
            methods: {
              datachange(value) {
                console.log('time', value)
                startDate = value[0]
                endDate = value[1]
                getPageDate()
              }
            }
          })
          var buy_source = []
          var group_type = []
          var month = []
          var day_group = []
          var last_year_month = []
          getPageDate()
          function getPageDate() {
            $.ajax({
              type: 'GET',
              data: {start:startDate , end: endDate},
              url: 'http://bigdata.xytschool.com/api/getCustomerSummary',
              dataType: 'json',
              success: function (data) {
                month = data.month_group.map(function (item){return item.value})
                last_year_month = data.day_group
                day_group = data.day_group

                char_6()
                char_5()
              },
              error: function (jqXHR) {
                console.log('Error: ' + jqXHR.status)
              }
            })

            $.ajax({
              //票务
              type: 'GET',
              data: {start:startDate , end: endDate},
              url: 'http://bigdata.xytschool.com/api/getCustomerSummary',
              dataType: 'json',
              success: function (data) {
                $('#customer_today').text(data.customer_today)
                $('#uphill').text(data.uphill)
                $('#downhill').text(data.downhill)
                $('#onhill').text(data.onhill)
                buy_source = data.buy_source
                group_type = data.group_type
                char_3()
                char_2()
                char_1()
                char_7()
              },
              error: function (jqXHR) {
                console.log('Error: ' + jqXHR.status)
              }
            })
          }

          char_5()
          char_4()
          function char_1() {
            for (var i = 0; i < group_type.length; i++) {
              if (group_type[i].type == 'group') {
                $('#current_team').text( parseInt(group_type[i].value / 30))
              } else if (group_type[i].type == 'online') {
                $('#current_tourist').text( parseInt(group_type[i].value / 30))
              } else if (group_type[i].type == 'sigle') {
                $('#current_distribution').text(parseInt(group_type[i].value / 30))
              }
            }
          }
          function char_6() {
            var myChart = echarts.init(document.getElementById('chart_6'))

            day_group_data = []
            for (var i = 0; i < day_group.length; i++) {
              day_group_data.push(day_group[i].value)
            }
            console.log(day_group_data)
            option = {
              tooltip: {
                trigger: 'axis',
                axisPointer: {
                  type: 'cross',
                  label: {
                    backgroundColor: '#6a7985'
                  }
                }
              },
              legend: {
                data: ['本期', '同期'],
                textStyle: {
                  color: '#fff'
                }
              },
              toolbox: {
                feature: {
                  saveAsImage: {}
                }
              },
              grid: {
                left: '0%',
                right: '4%',
                bottom: '3%',
                containLabel: true
              },
              xAxis: [
                {
                  type: 'category',
                  boundaryGap: false,
                  data: [
                    '1',
                    '2',
                    '3',
                    '4',
                    '5',
                    '6',
                    '7',
                    '8',
                    '9',
                    '10',
                    '11',
                    '12',
                    '13',
                    '14',
                    '15',
                    '16',
                    '17',
                    '18',
                    '19',
                    '20',
                    '21',
                    '22',
                    '23',
                    '24',
                    '25',
                    '26',
                    '27',
                    '28',
                    '29',
                    '30',
                    '31'
                  ],
                  axisLabel: {
                    formatter: '{value}',
                    textStyle: {
                      color: '#ffffff' //X轴文字颜色
                    }
                  }
                }
              ],
              yAxis: [
                {
                  type: 'value',

                  axisLabel: {
                    formatter: '{value}',
                    textStyle: {
                      color: '#ffffff' //X轴文字颜色
                    }
                  }
                }
              ],
              series: [
                {
                  name: '本期',
                  type: 'line',
                  stack: 'Total',
                  smooth: true,
                  lineStyle: {
                    width: 0
                  },
                  showSymbol: false,
                  areaStyle: {
                    opacity: 0.8,
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                      {
                        offset: 0,
                        color: 'rgba(128, 255, 165)'
                      },
                      {
                        offset: 1,
                        color: 'rgba(1, 191, 236)'
                      }
                    ])
                  },
                  emphasis: {
                    focus: 'series'
                  },
                  data: day_group_data
                },
                {
                  name: '同期',
                  type: 'line',
                  stack: 'Total',
                  smooth: true,
                  lineStyle: {
                    width: 0
                  },
                  showSymbol: false,
                  areaStyle: {
                    opacity: 0.8,
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                      {
                        offset: 0,
                        color: 'rgba(0, 221, 255)'
                      },
                      {
                        offset: 1,
                        color: 'rgba(77, 119, 255)'
                      }
                    ])
                  },
                  emphasis: {
                    focus: 'series'
                  },
                  data: last_year_month
                }
              ]
            }
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option)
            window.addEventListener('resize', function () {
              myChart.resize()
            })
          }
          function char_5() {
            //获取dom容器
            var myChart = echarts.init(document.getElementById('chart_5'))
            var month_value = []
            for (var i = 0; i < month.length; i++) {
              month_value.push(month[i].value)
            }
            console.log(month_value)
            option = {
              tooltip: {
                trigger: 'axis'
              },
              grid: {
                x: 40,
                y: 40,
                x2: 20,
                y2: 20
              },
              toolbox: {
                feature: {
                  //saveAsImage: {}
                }
              },
              xAxis: {
                type: 'category',
                boundaryGap: false,
                axisLabel: {
                  /*inside: true,*/
                  interval: 0,
                  textStyle: {
                    color: '#fff',
                    fontSize: 12
                  }
                },
                axisTick: {
                  show: false
                },
                axisLine: {
                  show: true,
                  symbol: ['none', 'arrow'],
                  symbolOffset: 12,
                  lineStyle: {
                    color: '#fff'
                  }
                },
                data: [
                  '1月',
                  '2月',
                  '3月',
                  '4月',
                  '5月',
                  '6月',
                  '7月',
                  '8月',
                  '9月',
                  '10月',
                  '11月',
                  '12月'
                ]
              },
              yAxis: {
                type: 'value',
                axisLine: {
                  show: true,
                  symbol: ['none', 'arrow'],
                  symbolOffset: 12,
                  lineStyle: {
                    color: '#fff'
                  }
                },
                axisTick: {
                  show: false
                },
                axisLabel: {
                  textStyle: {
                    color: '#fff',
                    fontSize: 12
                  }
                }
              },
              series: [
                {
                  type: 'line',
                  data: month,
                  itemStyle: {
                    normal: {
                      color: '#0efdff', //折线点的颜色
                      lineStyle: {
                        color: '#0efdff', //折线的颜色
                        width: 2
                      }
                    }
                  }
                }
              ]
            }

            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option)
            window.addEventListener('resize', function () {
              myChart.resize()
            })
          }
          function char_4() {
            var myChart = echarts.init(document.getElementById('chart_4'))

            option = {
              /*backgroundColor: 'rgb(3, 19, 52)',*/
              color: ['#2ea5c3', '#e08f68'],
              tooltip: {
                trigger: 'axis',
                axisPointer: {
                  type: 'shadow'
                }
              },

              grid: {
                //top:80,
                left: 20,
                bottom: 20,
                right: 40,
                containLabel: true
              },
              xAxis: {
                type: 'category',
                data: [
                  '2012',
                  '2013',
                  '2014',
                  '2015',
                  '2016',
                  '2017',
                  '2018',
                  '2010',
                  '2020',
                  '2021',
                  '2022'
                ],
                axisLabel: {
                  tooltip: {
                    show: true
                  },
                  inside: false,
                  textStyle: {
                    fontSize: 14
                  },
                  interval: 0,
                  color: 'rgba(255,255,255,0.6)'
                },
                axisTick: {
                  show: false
                },
                axisLine: {
                  lineStyle: {
                    color: '#0C1A5B'
                  }
                }
              },
              yAxis: [
                {
                  type: 'value',
                  splitLine: {
                    show: true,
                    lineStyle: {
                      color: 'rgba(255,255,255,0.1)'
                    }
                  },
                  axisTick: {
                    show: false
                  },
                  axisLine: {
                    lineStyle: {
                      color: '#0C1A5B'
                    }
                  },
                  axisLabel: {
                    textStyle: {
                      fontSize: 14
                    },
                    formatter: function (value) {
                      return value
                    },
                    color: 'rgba(255,255,255,0.6)'
                  }
                }
              ],
              series: [
                {
                  yAxisIndex: 0,
                  //barMinHeight:5,
                  barCategoryGap: '30%',
                  itemStyle: {
                    normal: {
                      label: {
                        show: true,
                        position: 'top',
                        color: '#fff',
                        fontSize: 14
                      },
                      color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        {
                          offset: 0,
                          color: '#A43EE5'
                        },
                        {
                          offset: 1,
                          color: '#CE7C13'
                        }
                      ]),
                      opacity: 1,
                      shadowBlur: 5,
                      shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                  },
                  type: 'bar',
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10]
                }
              ]
            }
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option)
            window.addEventListener('resize', function () {
              myChart.resize()
            })
          }
          function char_3() {
            for (var i = 0; i < buy_source.length; i++) {
              buy_source[i].name = buy_source[i].buy_source
            }
            var myChart = echarts.init(document.getElementById('chart3'))
            option = {
              tooltip: {
                trigger: 'item'
              },
              label: {
                color: '#fff',
                show: true, // 显示文字
                formatter: function (arg) {
                  console.log(arg)
                  return arg.name + arg.value + '张\n' + arg.percent + '%'
                }
              },
              legend: {
                top: '5%',
                left: 'center',
                textStyle: {
                  color: '#fff'
                }
              },
              series: [
                {
                  type: 'pie',
                  labelLine: {
                    show: false
                  },
                  data: buy_source
                }
              ]
            }
            myChart.setOption(option)

            window.addEventListener('resize', function () {
              myChart.resize()
            })
          }
          function char_2() {
            let buy_source_name = []
            let buy_source_value = []

            for (var i = 0; i < buy_source.length; i++) {
              buy_source_value.push(buy_source[i].value)
              buy_source_name.push(buy_source[i].buy_source)
            }
            var myChart = echarts.init(document.getElementById('chart2'))

            var salvProMax = [] //背景按最大值
            for (let i = 0; i < buy_source_value.length; i++) {
              salvProMax.push(buy_source_value[0])
            }
            option = {
              grid: {
                left: '2%',
                right: '2%',
                bottom: '-6%',
                top: '8%',
                containLabel: true
              },
              tooltip: {
                trigger: 'axis',
                axisPointer: {
                  type: 'none'
                },
                formatter: function (params) {
                  return params[0].name + ' : ' + params[0].value
                }
              },
              xAxis: {
                show: false,
                type: 'value'
              },
              yAxis: [
                {
                  type: 'category',
                  inverse: true,
                  axisLabel: {
                    show: true,
                    textStyle: {
                      color: '#fff'
                    }
                  },
                  splitLine: {
                    show: false
                  },
                  axisTick: {
                    show: false
                  },
                  axisLine: {
                    show: false
                  },
                  data: buy_source_name
                },
                {
                  type: 'category',
                  inverse: true,
                  axisTick: 'none',
                  axisLine: 'none',
                  show: true,
                  axisLabel: {
                    textStyle: {
                      color: '#ffffff',
                      fontSize: '12'
                    }
                  },
                  data: buy_source_value
                }
              ],
              series: [
                {
                  name: '值',
                  type: 'bar',
                  zlevel: 1,
                  itemStyle: {
                    normal: {
                      barBorderRadius: 30,
                      color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                        {
                          offset: 0,
                          color: 'rgb(57,89,255,1)'
                        },
                        {
                          offset: 1,
                          color: 'rgb(46,200,207,1)'
                        }
                      ])
                    }
                  },
                  barWidth: 10,
                  data: buy_source_value
                },
                {
                  name: '背景',
                  type: 'bar',
                  barWidth: 10,
                  barGap: '-100%',
                  data: salvProMax,
                  itemStyle: {
                    normal: {
                      color: 'rgba(24,31,68,1)',
                      barBorderRadius: 30
                    }
                  }
                }
              ]
            }

            myChart.setOption(option)
          }
          function char_7() {
            var myChart = echarts.init(document.getElementById('product'))
            var buy_source_name = []
            var buy_source_value = []

            for (var i = 0; i < buy_source.length; i++) {
              buy_source_name.push(buy_source[i].buy_source)
              buy_source_value.push(buy_source[i].value)
            }
            option = {
              xAxis: {
                type: 'category',
                data: buy_source_name,
                axisLabel: {
                  show: true,
                  textStyle: {
                    color: '#fff'
                  }
                }
              },
              yAxis: {
                type: 'value',
                axisLabel: {
                  show: true,
                  textStyle: {
                    color: '#fff'
                  }
                }
              },
              tooltip: {
                trigger: 'axis',
                axisPointer: {
                  type: 'shadow'
                }
              },
              series: [
                {
                  data: buy_source_value,
                  type: 'bar',
                  showBackground: true,
                  backgroundStyle: {
                    color: 'rgba(180, 180, 180, 0.2)'
                  }
                }
              ]
            }
            myChart.setOption(option)
          }
        </script>
      </body>
    </html>
  </head>
</html>
